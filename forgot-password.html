<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>Forgot Password - Sale Support System</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style.css">
</head>

<body class="center-layout">

<div class="card" style="max-width:420px">

    <div class="card-title">р╕ер╕╖р╕бр╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щ</div>
    <div class="card-subtitle">Sale Support System</div>

    <div class="info-box">
        ЁЯУз р╕Бр╕гр╕╕р╕Ур╕▓р╕Бр╕гр╕нр╕Бр╕нр╕╡р╣Ар╕бр╕ер╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щ  
        р╕гр╕░р╕Ър╕Ър╕Ир╕░р╕кр╣Ир╕Зр╕ер╕┤р╕Зр╕Бр╣Мр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Хр╕▒р╣Йр╕Зр╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щр╣Гр╕лр╕бр╣Ир╣Гр╕лр╣Йр╕Др╕╕р╕У
    </div>

    <form id="forgotForm">

        <div class="form-group">
            <label>р╕нр╕╡р╣Ар╕бр╕е</label>
            <input
                type="email"
                class="input"
                id="email"
                placeholder="name@company.com"
                required
            >
        </div>

        <button type="submit" class="btn" id="sendBtn">
            р╕кр╣Ир╕Зр╕ер╕┤р╕Зр╕Бр╣Мр╕гр╕╡р╣Ар╕Лр╣Зр╕Хр╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щ
        </button>

    </form>

    <div class="text-center" style="margin-top:20px">
        <a class="link" href="index.html">тЖР р╕Бр╕ер╕▒р╕Ър╕лр╕Щр╣Йр╕▓р╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ъ</a>
    </div>

</div>

<!-- ===== Firebase Forgot Password Script ===== -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
import { getAuth, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

/* ЁЯФе Firebase Config (р╣Гр╕Кр╣Йр╕Кр╕╕р╕Фр╣Ар╕Фр╕╡р╕вр╕зр╕Бр╕▒р╕Ъ Login / Register) */
const firebaseConfig = {
    apiKey: "AIzaSyCsUhBsWjZfQuJo5lgprYt3xikQUyf8iiw",
    authDomain: "sale-support-system.firebaseapp.com",
    projectId: "sale-support-system",
    storageBucket: "sale-support-system.appspot.com",
    messagingSenderId: "640337786680",
    appId: "1:640337786680:web:fd80699ac291b8d7a7b3cd"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

const form = document.getElementById("forgotForm");
const btn = document.getElementById("sendBtn");

form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const email = document.getElementById("email").value.trim();

    btn.disabled = true;
    btn.innerText = "р╕Бр╕│р╕ер╕▒р╕Зр╕кр╣Ир╕Зр╕нр╕╡р╣Ар╕бр╕е...";

    try {
        await sendPasswordResetEmail(auth, email);
        alert("р╕кр╣Ир╕Зр╕ер╕┤р╕Зр╕Бр╣Мр╕Хр╕▒р╣Йр╕Зр╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щр╣Гр╕лр╕бр╣Ир╣Ар╕гр╕╡р╕вр╕Ър╕гр╣Йр╕нр╕вр╣Бр╕ер╣Йр╕з\nр╕Бр╕гр╕╕р╕Ур╕▓р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕нр╕╡р╣Ар╕бр╕е");

        window.location.href = "index.html";

    } catch (err) {
        console.error(err);

        if (err.code === "auth/user-not-found") {
            alert("р╣Др╕бр╣Ир╕Юр╕Ър╕нр╕╡р╣Ар╕бр╕ер╕Щр╕╡р╣Йр╣Гр╕Щр╕гр╕░р╕Ър╕Ъ");
        } else {
            alert("р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╣Ир╕Зр╕нр╕╡р╣Ар╕бр╕ер╣Др╕Фр╣Й");
        }

        btn.disabled = false;
        btn.innerText = "р╕кр╣Ир╕Зр╕ер╕┤р╕Зр╕Бр╣Мр╕гр╕╡р╣Ар╕Лр╣Зр╕Хр╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щ";
    }
});
</script>

</body>
</html>
