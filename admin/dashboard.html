<div class="green-container" style="max-width: 1000px; margin-top: 20px; border-top: 6px solid #3B82F6;">
    <h3 style="color: #1E40AF;">üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (User Management)</h3>
    <div style="overflow-x: auto;">
        <table style="width:100%; border-collapse: collapse; font-size: 0.9rem;">
            <thead>
                <tr style="background: #f4f4f4; text-align: left;">
                    <th style="padding: 10px; border-bottom: 2px solid #ddd;">Email</th>
                    <th style="padding: 10px; border-bottom: 2px solid #ddd;">Role ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</th>
                    <th style="padding: 10px; border-bottom: 2px solid #ddd;">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏õ‡πá‡∏ô</th>
                </tr>
            </thead>
            <tbody id="userTableBody">
                <tr><td colspan="3" style="text-align:center; padding:20px;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠...</td></tr>
            </tbody>
        </table>
    </div>
</div>

<script type="module">
    // (‡πÉ‡∏ä‡πâ Firebase Config ‡πÅ‡∏•‡∏∞ Import ‡∏ä‡∏∏‡∏î‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)
    // ... 

    // 3. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ User ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    async function loadAllUsers() {
        const querySnapshot = await getDocs(collection(db, "users"));
        const tbody = document.getElementById('userTableBody');
        tbody.innerHTML = "";
        
        querySnapshot.forEach((userDoc) => {
            const userData = userDoc.data();
            const tr = document.createElement('tr');
            tr.style.borderBottom = "1px solid #eee";
            tr.innerHTML = `
                <td style="padding: 10px;">${userData.email}</td>
                <td style="padding: 10px;"><span class="role-badge">${userData.role}</span></td>
                <td style="padding: 10px;">
                    <select onchange="window.updateUserRole('${userDoc.id}', this.value)" style="padding:5px; border-radius:4px;">
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô --</option>
                        <option value="user">User (Sale)</option>
                        <option value="supervisor">Supervisor</option>
                        <option value="admin">Admin</option>
                    </select>
                </td>
            `;
            tbody.appendChild(tr);
        });
    }

    // 4. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Role
    window.updateUserRole = async (uid, newRole) => {
        if(!newRole) return;
        if(confirm(`‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏õ‡πá‡∏ô ${newRole} ?`)) {
            const userRef = doc(db, "users", uid);
            await updateDoc(userRef, { role: newRole });
            alert("‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!");
            loadAllUsers();
        }
    };

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤
    loadAllUsers();
</script>
